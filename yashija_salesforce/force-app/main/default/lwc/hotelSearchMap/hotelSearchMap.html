<template>
    <lightning-card title="Ìò∏ÌÖî Í≤ÄÏÉâ ÏßÄÎèÑ" icon-name="standard:location">
        <div class="slds-p-horizontal_medium">
            <!-- Í≤ÄÏÉâ ÌïÑÌÑ∞ -->
            <div class="search-filters slds-m-bottom_medium">
                <div class="slds-grid slds-gutters">
                    <div class="slds-col slds-size_1-of-4">
                        <lightning-combobox
                            name="region"
                            label="ÏßÄÏó≠"
                            value={selectedRegion}
                            placeholder="ÏßÄÏó≠ ÏÑ†ÌÉù"
                            options={regionOptions}
                            onchange={handleRegionChange}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col slds-size_1-of-4">
                        <lightning-combobox
                            name="district"
                            label="Íµ¨/Ïãú"
                            value={selectedDistrict}
                            placeholder="Íµ¨/Ïãú ÏÑ†ÌÉù"
                            options={districtOptions}
                            onchange={handleDistrictChange}
                            disabled={isDistrictDisabled}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col slds-size_1-of-4">
                        <lightning-combobox
                            name="grade"
                            label="Ìò∏ÌÖî Îì±Í∏â"
                            value={selectedGrade}
                            placeholder="Ï†ÑÏ≤¥"
                            options={gradeOptions}
                            onchange={handleGradeChange}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col slds-size_1-of-4 slds-align-bottom">
                        <lightning-button
                            variant="brand"
                            label="Í≤ÄÏÉâ"
                            title="Ìò∏ÌÖî Í≤ÄÏÉâ"
                            icon-name="utility:search"
                            onclick={handleSearch}
                            disabled={isSearchDisabled}
                            class="slds-m-top_small">
                        </lightning-button>
                    </div>
                </div>
            </div>
            
            <!-- Í≤ÄÏÉâ Í≤∞Í≥º ÏöîÏïΩ -->
            <template if:true={hotelCount}>
                <div class="search-summary slds-m-bottom_small">
                    <p class="slds-text-body_regular">
                        <strong>{hotelCount}Í∞ú</strong>Ïùò Ìò∏ÌÖîÏù¥ Í≤ÄÏÉâÎêòÏóàÏäµÎãàÎã§.
                    </p>
                </div>
            </template>
            
            <!-- Î°úÎî© Ïä§ÌîºÎÑà -->
            <template if:true={isLoading}>
                <div class="slds-text-align_center slds-m-bottom_medium">
                    <lightning-spinner alternative-text="Î°úÎî© Ï§ë..." size="small"></lightning-spinner>
                </div>
            </template>
            
            <!-- Ïò§Î•ò Î©îÏãúÏßÄ -->
            <template if:true={errorMessage}>
                <div class="slds-m-bottom_medium">
                    <div class="slds-notify slds-notify_alert slds-alert_error">
                        <span class="slds-assistive-text">Ïò§Î•ò</span>
                        <h2>{errorMessage}</h2>
                    </div>
                </div>
            </template>
            
            <!-- ÏßÄÎèÑ ÏòÅÏó≠ -->
            <div class="map-container">
                <div class="map-div" lwc:dom="manual"></div>
                
                <!-- Ìôà Î≤ÑÌäº (ÏôºÏ™Ω ÏÉÅÎã®) -->
                <button class="map-control-btn home-btn" onclick={goToHome} title="Í∏∞Î≥∏ ÏúÑÏπòÎ°ú">
                    <lightning-icon icon-name="utility:home" size="small"></lightning-icon>
                </button>
            </div>
            
            <!-- Î≤îÎ°Ä -->
            <template if:true={isMapInitialized}>
                <div class="legend-container slds-m-top_medium">
                    <div class="slds-text-title_caps slds-m-bottom_x-small">Ìò∏ÌÖî Îì±Í∏â Î≤îÎ°Ä</div>
                    <div class="legend-items">
                        <span class="legend-item">
                            <span class="legend-color" style="background-color: #6B46C1;">
                                <span style="font-size: 12px;">üè®</span>
                                <span class="legend-number" style="color: #6B46C1;">5</span>
                            </span>
                            <span class="legend-label">5ÏÑ±Í∏â</span>
                        </span>
                        <span class="legend-item">
                            <span class="legend-color" style="background-color: #EC4899;">
                                <span style="font-size: 12px;">üè®</span>
                                <span class="legend-number" style="color: #EC4899;">4</span>
                            </span>
                            <span class="legend-label">4ÏÑ±Í∏â</span>
                        </span>
                        <span class="legend-item">
                            <span class="legend-color" style="background-color: #3B82F6;">
                                <span style="font-size: 12px;">üè®</span>
                                <span class="legend-number" style="color: #3B82F6;">3</span>
                            </span>
                            <span class="legend-label">3ÏÑ±Í∏â</span>
                        </span>
                        <span class="legend-item">
                            <span class="legend-color" style="background-color: #10B981;">
                                <span style="font-size: 12px;">üè®</span>
                                <span class="legend-number" style="color: #10B981;">2</span>
                            </span>
                            <span class="legend-label">2ÏÑ±Í∏â</span>
                        </span>
                        <span class="legend-item">
                            <span class="legend-color" style="background-color: #6B7280;">
                                <span style="font-size: 12px;">üè®</span>
                                <span class="legend-number" style="color: #6B7280;">1</span>
                            </span>
                            <span class="legend-label">1ÏÑ±Í∏â</span>
                        </span>
                    </div>
                </div>
            </template>
        </div>
    </lightning-card>
</template>